spring:
  application:
    name: "gatewayserver"
  config:
    import: "optional:configserver:http://localhost:8071/"
  cloud: # With this configuration, I tell my gateway, please connect with the discovery server which is Eureka server, and locate all the details about the microservices.
    gateway:
      discovery:
        locator:
          enabled: false # to disable the default routing configuration of gateway server because we have created our custom routing.
          lower-case-service-id: true # Please accept the service name with the completely lowercase.
      httpclient: # Timeout configuration for all the microservices that we have
        connect-timeout: 1000
        response-timeout: 2s


# This is for refreshing configurations at runtime using refresh actuator path
# To enable the actuator API paths. By default, Actuator is not going to expose all the management related API paths. That's why we need to specifically enable them.
management:
  endpoints:
    web:
      exposure:
        include: "*" # means please enable and expose all management endpoint supported by the Spring Boot Actuator.
  endpoint: # to enable the gateway related endpoints inside the actuator
    gateway:
      enabled: true
  info:
    env:
      enabled: true


# The purpose of why we added these info related information is the same information we can see inside the Eureka dashboard.
info:
  app:
    name: "gatewayserver"
    description: "DekanBANK Gateway Server Application"
    version: "1.0.0"

logging:
  level:
    com:
      dekankilic:
        gatewayserver: debug

resilience4j.circuitbreaker:
  configs:
    default:
      slidingWindowSize: 10 # Using this property, we are communicating to the circuit breaker pattern on how many requests it has to initially monitor before it tries to change the status from close to open. Please monitor at least 10 requests coming towards my account microservice
      permittedNumberOfCallsInHalfOpenState: 2 # In the half_open state, 2 request will be allowed to request.
      failureRateThreshold: 50 # If at least 50% of the requests are failed, then circuit breaker pattern can move to the open state from the close state.
      waitDurationInOpenState: 10000 # My circuit breaker pattern is going to wait 10s whenever it tries to move the half_open state and allow the partial traffic.